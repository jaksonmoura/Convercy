<!DOCTYPE html>
<!--
	Built by Jakson Rochelly
	@jrochelly
-->
<html>
	<head>
		<link rel="stylesheet" href="layout.css">
		<script src='jquery.js'></script>
		<title>Calculator Teste</title>
	</head>
	<body>
		<header>
			<div id="logo">Money Converter</div>
		</header>
		<div id="selects">
			<div id="from_select">
				<select name="from" id="from">
					<option selected="selected" value="USD">Dollar - USD</option>
					<option value="EUR">Euro - EUR</option>
					<option value="GBP">UK Pound - GBP</option>
					<option value="JPY">Yen - JPY</option>
					<option value="INR">Rupee - INR</option>
					<option value="BRL">Real - BRL</option>
					<option value="CNY">Yuan - CNY</option>
					<option value="ZAR">Rand - ZAR</option>
				</select>
			</div>

			<div id="to_select">
				<select name="to" id="to">
					<option value="USD">Dollars - USD</option>
					<option selected="selected" value="EUR">Euro - EUR</option>
					<option value="GBP">UK Pound - GBP</option>
					<option value="JPY">Yen - JPY</option>
					<option value="INR">Rupee - INR</option>
					<option value="BRL">Real - BRL</option>
					<option value="CNY">Yuan - CNY</option>
					<option value="ZAR">Rand - ZAR</option>
				</select>
			</div>
		</div>
		<div id="wrapper">

			<div id="display">
				<div id="result">
					<small>getting data...</small>
				</div>
			</div>
			<input type="number" class="amount" name="amount" id="amount" value="1" autofocus/>
	<div id="hidden-resizer" style="visibility: hidden"></div>
		</div>
	</body>
	<script>
		var rate = null;
		var from = null;
		var to = null;

		getRate = function() {	
			$('#result').html("<small>getting data...</small>");
			// Getting Values
			from = $('#from').val();
			to = $('#to').val();
			url = "http://rate-exchange.appspot.com/currency?from=" + from + "&to=" + to + "&calback=jsonpCallback";
			$.ajax({
			url: url,
			type: "POST",
			async: false,
			dataType: "jsonp",
			success : function(data) 
			{

				rate = parseFloat(data.rate);
				showConvertion(to);
			}
			});
		};

		showConvertion = function(to){
			var amount = $('#amount').val();
			result = amount * rate;
			if (rate) {
				$('#result').html("<div id='currency'><span>"+ to +"</span></div><div id='result_value'><p>" + result.toFixed(2)+ "</p></div>");
			} else {
				$('#result').html("<div id='currency'><span>"+ to +"</span></div>1.00<small><i> of course! :P</i></small>");
			};
		};

		$(document).ready(function (){ getRate(); });
		$('#from, #to').change(function (){	getRate(); });
		$('#amount').keyup(function (){
			showConvertion(to);
			if ($('#result_value p').width() > $('#result_value').width()) {
				while( $('#result_value p').width() > $('#result_value').width() ) {
					$('#result_value p').css('font-size', (parseInt($('#result_value p').css('font-size'))) - 1 );
				};
			};
			
		});
	</script>
</html>